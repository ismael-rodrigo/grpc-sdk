#include<iostream>
using namespace std;
#include<string>
#include<stdlib.h>
#include"SerialPort.h"

char output[MAX_DATA_LENGTH];
char incomingData[MAX_DATA_LENGTH];

// change the name of the port with the port name of your computer
// must remember that the backslashes are essential so do not remove them
char *port = "COM7";

int main(){
	SerialPort arduino(port);
    cout<<"Enter your port: "<<endl;
    string portset;
    cin>>portset;
    arduino.setConfig(portset.c_str(), 9600);
    
	if(arduino.isConnected()){
		cout<<"Connection made"<<endl<<endl;
	}
	else{
		cout<<"Error in port name"<<endl<<endl;
	}
	while(arduino.isConnected()){
		cout<<"Enter your command: "<<endl;
		string data;
		cin>>data;

		char *charArray = new char[data.size()];
		copy(data.begin(), data.end(), charArray);
		arduino.writeSerialPort(charArray, data.size());
        arduino.readSerialPort(output, MAX_DATA_LENGTH);

		cout<<">> "<<output<<endl;
		delete [] charArray;
	}
	return 0;
}